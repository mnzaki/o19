// GENERATED BY SPIRE-LOOM - DO NOT EDIT (even if LLM)
// 
// This file is automatically generated from a template.
// Changes will be overwritten on next generation.
// 
// Template: node_modules/@o19/spire-loom/machinery/bobbin/ddd/adaptor.ts.ejs
// Template file: adaptor.ts.ejs
// To override: Copy this template to loom/bobbin/ddd/adaptor.ts.ejs
// 
// To modify the generated output, edit the template file above.
/**
 * Conversation Adaptor Implementations
 * 
 * Concrete adaptor implementations for Conversation operations.
 * - KyselyAdaptor: Read operations via Kysely (SQLite)
 * - TauriAdaptor: Write operations via Tauri commands (calls Rust core)
 * 
 * @generated by ddd-services treadle
 */

import { invoke } from '@tauri-apps/api/core';
import type { Kysely } from 'kysely';
import type { DB } from '../../db/types.js';
import type {
  ConversationReadAdaptor,
  ConversationWriteAdaptor
} from '../../ports/gen/conversation.port.gen.js';

/**
 * Kysely-based read adaptor for Conversation
 */
export class ConversationKyselyAdaptor implements ConversationReadAdaptor {
  constructor(private db: Kysely<DB>) {}

  async getConversation(
    conversationId: string,
  ): Promise<Conversation> {
    // TODO: Implement Kysely query
    // Example: return this.db.selectFrom('conversation').selectAll()...
    throw new Error('get_conversation not yet implemented in Kysely adaptor');
  }

  async listConversations(
  ): Promise<string[][]> {
    // TODO: Implement Kysely query
    // Example: return this.db.selectFrom('conversation').selectAll()...
    throw new Error('list_conversations not yet implemented in Kysely adaptor');
  }

}

/**
 * Tauri-based write adaptor for Conversation
 */
export class ConversationTauriAdaptor implements ConversationWriteAdaptor {

  async addConversation(
    conversationId: string,
    title?: string,
    participants?: string[],
  ): Promise<void> {
    return invoke('add_conversation', {
      conversationId,
      title,
      participants,
    });
  }

  async updateConversation(
    conversationId: string,
    title?: string,
    participants?: string[],
  ): Promise<boolean> {
    return invoke('update_conversation', {
      conversationId,
      title,
      participants,
    });
  }

  async deleteConversation(
    conversationId: string,
  ): Promise<boolean> {
    return invoke('delete_conversation', {
      conversationId,
    });
  }
}

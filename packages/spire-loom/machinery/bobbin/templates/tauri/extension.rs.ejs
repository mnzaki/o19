//! AppHandle Extension - GENERATED by spire-loom
//!
//! Extension trait for accessing plugin state from AppHandle.
//!
//! Generated from <%= coreName %> Management definitions.

use std::path::PathBuf;
use tauri::{Manager, Runtime};
use <%= coreCrateName %>::signal::EventBus;
use <%= coreCrateName %>::thestream::TheStream;
use crate::platform::Platform;

/// Extension trait for accessing plugin state.
pub trait O19Extension<R: Runtime> {
  /// Access the platform implementation.
  fn platform(&self) -> &dyn Platform;

  /// Access the event bus.
  fn events(&self) -> &EventBus;

  /// Access the database.
  fn db(&self) -> &foundframe_to_sql::Database;

  /// Access TheStream for adding content.
  fn stream(&self) -> &TheStream;

  /// Get the database path.
  fn db_path(&self) -> PathBuf;
}

impl<R: Runtime, T: Manager<R>> O19Extension<R> for T {
  fn platform(&self) -> &dyn Platform {
    &*self.state::<crate::AppState>().inner().platform
  }

  fn events(&self) -> &EventBus {
    &self.state::<crate::AppState>().inner().events
  }

  fn db(&self) -> &foundframe_to_sql::Database {
    &self.state::<crate::AppState>().inner().db
  }

  fn stream(&self) -> &TheStream {
    self.state::<crate::AppState>().inner().platform.stream()
  }

  fn db_path(&self) -> PathBuf {
    self.state::<crate::AppState>().inner().db_path.clone()
  }
}

// GENERATED BY kysely-adaptor Treadle - Do not edit
// Factory function for creating all Kysely adaptors

import { Kysely } from 'kysely';
import type { DB } from '../db/types.js';
<% entities.forEach(function(entity) { -%>
import { Kysely<%= entity.pascal %>Adaptor } from './<%= entity.lower %>.adaptor.gen.js';
<% }); -%>

// Import port types
import type {
<% entities.forEach(function(entity, i) { -%>
  <%= entity.pascal %>Port<%= i < entities.length - 1 ? ',' : '' %>
<% }); -%>
} from '../ports/index.js';

/**
 * All database ports interface
 */
export interface DatabasePorts {
<% entities.forEach(function(entity) { -%>
  <%= entity.lower %>: <%= entity.pascal %>Port;
<% }); -%>
}

/**
 * Create all Kysely adaptors with the given database instance
 *
 * @example
 * ```typescript
 * import { Kysely } from 'kysely';
 * import { createKyselyAdaptors } from './adaptors/gen/factory.gen.js';
 *
 * const db = new Kysely<DB>({
 *   dialect: new SQLiteDialect({ database: new SQLiteDb('app.db') })
 * });
 *
 * const adaptors = createKyselyAdaptors(db);
 *
 * // Use adaptors
 * const <%= entities[0]?.lower || 'entity' %> = await adaptors.<%= entities[0]?.lower || 'entity' %>.getById(1);
 * ```
 */
export function createKyselyAdaptors(db: Kysely<DB>): DatabasePorts {
  return {
<% entities.forEach(function(entity, i) { -%>
    <%= entity.lower %>: new Kysely<%= entity.pascal %>Adaptor(db)<%= i < entities.length - 1 ? ',' : '' %>
<% }); -%>
  };
}

/**
 * Convenience export for single adaptor creation
 */
export {
<% entities.forEach(function(entity, i) { -%>
  Kysely<%= entity.pascal %>Adaptor<%= i < entities.length - 1 ? ',' : '' %>
<% }); -%>
};

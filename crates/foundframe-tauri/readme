# RustExternalLayer Spire - Generated Tauri Plugin Components

> **GENERATED BY SPIRE-LOOM** - This directory contains auto-generated code.
> Do not edit files here directly. Modify templates in `machinery/bobbin/tauri/` instead.

## Architecture

The Spire module provides a **separate but complementary** platform abstraction to the main Tauri plugin's `Platform` trait:

### Two Platform Abstractions

| Layer | Location | Purpose |
|-------|----------|---------|
| **Main Platform** | `src/platform.rs`, `src/desktop.rs` | Custom methods (pairing, camera, etc.) |
| **Spire Platform** | `spire/src/platform.rs`, `spire/src/desktop.rs` | Generated methods from Management imprints |

### How They Work Together

Both platforms are registered under the **same plugin name** (`o19-RustExternalLayer-tauri`):

```rust
// In your main src/lib.rs
pub fn init<R: Runtime>() -> TauriPlugin<R> {
  Builder::new("o19-RustExternalLayer-tauri")
    .invoke_handler(tauri::generate_handler![
      // Commands auto-generated in spire/src/commands.rs
    ])
    .setup(|app, api| {
      // Setup main platform (custom methods)
      let platform = init_platform(app, api)?;
      
      // Setup spire platform (generated methods)  
      let spire = crate::spire::setupSpireRustExternalLayer(app, api)?;
      
      Ok(())
    })
    .build()
}
```

### Design Rationale

- **Main Platform** (`Platform` trait): Hand-written custom logic for device pairing, camera, permissions, etc.
- **Spire Platform** (`SpireRustExternalLayerPlatformTrait`): Auto-generated from `loom/*.ts` Management imprints - bookmark CRUD, device pairing codes, etc.

This separation allows:
1. **Custom logic** to evolve independently of generated code
2. **Generated code** to be regenerated without losing custom implementations
3. **Both** to coexist under the same plugin namespace

## Generated Files

| File | Purpose |
|------|---------|
| `spire/src/lib.rs` | Plugin setup, platform muxing |
| `spire/src/platform.rs` | Platform trait definition (generated methods) |
| `spire/src/desktop.rs` | Desktop implementation (direct RustExternalLayer calls) |
| `spire/src/mobile/android.rs` | Android implementation (JNI/service calls) |
| `spire/src/commands.rs` | Tauri command handlers |
| `spire/src/extension.rs` | AppHandle extension trait |
| `spire/src/models.rs` | Request/response types |
| `spire/src/error.rs` | Error types |

## Usage

Access the spire platform via the extension trait:

```rust
use crate::spire::SpireRustExternalLayerExt;

fn handle_request<R: Runtime>(app: AppHandle<R>) {
  // Call generated method
  app.spireRustExternalLayerPlatform().bookmark_add_bookmark();
}
```

Or use directly:

```rust
use crate::spire::SpireRustExternalLayerPlatform;

async fn setup(app: &AppHandle) {
  // Platform is already managed by plugin setup
  let platform = app.state::<SpireRustExternalLayerPlatform>();
}
```

## Regeneration

To regenerate after changing `loom/*.ts`:

```bash
cd o19
pnpm spire-loom
```

---

*Generated from WARP.ts Management imprints by spire-loom*
